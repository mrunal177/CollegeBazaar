<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CampusBazaar â€” Campus Marketplace on Algorand</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;1,9..40,300&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />

  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DESIGN TOKENS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      --navy:       #080e1a;
      --navy-2:     #0d1628;
      --navy-3:     #111e35;
      --navy-4:     #1a2d4a;
      --navy-5:     #1e3457;
      --green:      #00e676;
      --green-dim:  #00c853;
      --green-glow: rgba(0, 230, 118, 0.15);
      --amber:      #ffab40;
      --amber-dim:  #ff8f00;
      --amber-glow: rgba(255, 171, 64, 0.15);
      --blue-acc:   #40c4ff;
      --text-1:     #eef2ff;
      --text-2:     #94a3c0;
      --text-3:     #5a6a84;
      --border:     rgba(255,255,255,0.07);
      --border-2:   rgba(255,255,255,0.12);
      --card-bg:    rgba(13, 22, 40, 0.85);
      --radius:     16px;
      --radius-sm:  10px;
      --transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESET & BASE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--navy);
      color: var(--text-1);
      min-height: 100vh;
      overflow-x: hidden;
      cursor: default;
    }

    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: var(--navy-2); }
    ::-webkit-scrollbar-thumb { background: var(--navy-5); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--green-dim); }

    h1, h2, h3, h4 { font-family: 'DM Serif Display', serif; font-weight: 400; }

    a { text-decoration: none; color: inherit; }
    button { cursor: pointer; border: none; background: none; font-family: inherit; }
    input, textarea, select { font-family: inherit; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CANVAS BACKGROUND
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #bg-canvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NOISE OVERLAY
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
      opacity: 0.4;
      pointer-events: none;
      z-index: 1;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       APP WRAPPER
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #app {
      position: relative;
      z-index: 2;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NAV
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    nav {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 2rem;
      height: 64px;
      background: rgba(8, 14, 26, 0.85);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-family: 'DM Serif Display', serif;
      font-size: 1.3rem;
      color: var(--text-1);
    }

    .nav-logo-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--green), var(--blue-acc));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .nav-link {
      padding: 0.4rem 0.9rem;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-2);
      transition: var(--transition);
    }

    .nav-link:hover, .nav-link.active {
      color: var(--text-1);
      background: var(--border);
    }

    .nav-link.active { color: var(--green); }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .nav-wallet {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0.4rem 0.9rem;
      border-radius: 20px;
      border: 1px solid var(--border-2);
      font-size: 0.8rem;
      color: var(--text-2);
      background: var(--navy-3);
      font-family: 'JetBrains Mono', monospace;
      transition: var(--transition);
    }

    .nav-wallet:hover { border-color: var(--green); color: var(--green); }

    .wallet-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--green);
      box-shadow: 0 0 8px var(--green);
      animation: pulse-dot 2s infinite;
    }

    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }

    .btn-primary {
      padding: 0.5rem 1.25rem;
      background: var(--green);
      color: var(--navy);
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      transition: var(--transition);
    }

    .btn-primary:hover {
      background: var(--green-dim);
      transform: translateY(-1px);
      box-shadow: 0 4px 20px var(--green-glow);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PAGE SYSTEM
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.4s ease; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       HOME / HERO
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .hero {
      min-height: calc(100vh - 64px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 4rem 2rem;
      text-align: center;
      position: relative;
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 0.35rem 0.9rem;
      border-radius: 20px;
      border: 1px solid rgba(0, 230, 118, 0.3);
      background: rgba(0, 230, 118, 0.06);
      font-size: 0.78rem;
      color: var(--green);
      font-weight: 500;
      letter-spacing: 0.02em;
      margin-bottom: 2rem;
      animation: slideDown 0.6s ease both;
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-16px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .hero h1 {
      font-size: clamp(3rem, 7vw, 6rem);
      line-height: 1.05;
      letter-spacing: -0.02em;
      max-width: 860px;
      animation: slideUp 0.7s ease 0.1s both;
    }

    .hero h1 em {
      font-style: italic;
      color: var(--green);
    }

    .hero-sub {
      margin-top: 1.5rem;
      font-size: 1.15rem;
      color: var(--text-2);
      max-width: 540px;
      line-height: 1.7;
      font-weight: 300;
      animation: slideUp 0.7s ease 0.2s both;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .hero-cta {
      display: flex;
      gap: 1rem;
      margin-top: 2.5rem;
      flex-wrap: wrap;
      justify-content: center;
      animation: slideUp 0.7s ease 0.3s both;
    }

    .btn-hero {
      padding: 0.85rem 2rem;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      transition: var(--transition);
    }

    .btn-hero-solid {
      background: var(--green);
      color: var(--navy);
    }

    .btn-hero-solid:hover {
      background: var(--green-dim);
      transform: translateY(-2px);
      box-shadow: 0 8px 32px var(--green-glow);
    }

    .btn-hero-outline {
      border: 1px solid var(--border-2);
      color: var(--text-1);
      background: var(--navy-3);
    }

    .btn-hero-outline:hover {
      border-color: var(--green);
      color: var(--green);
      transform: translateY(-2px);
    }

    .hero-stats {
      display: flex;
      gap: 3rem;
      margin-top: 4rem;
      flex-wrap: wrap;
      justify-content: center;
      animation: slideUp 0.7s ease 0.4s both;
    }

    .hero-stat { text-align: center; }

    .hero-stat-num {
      font-family: 'DM Serif Display', serif;
      font-size: 2.2rem;
      color: var(--text-1);
    }

    .hero-stat-num span { color: var(--green); }

    .hero-stat-label {
      font-size: 0.8rem;
      color: var(--text-3);
      margin-top: 0.2rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    /* Scroll indicator */
    .scroll-hint {
      position: absolute;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      color: var(--text-3);
      font-size: 0.75rem;
      animation: bob 2s ease-in-out infinite;
    }

    @keyframes bob {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(6px); }
    }

    .scroll-arrow { font-size: 1rem; }

    /* How it works strip */
    .how-strip {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1px;
      background: var(--border);
      border-top: 1px solid var(--border);
      border-bottom: 1px solid var(--border);
      margin: 2rem 0;
    }

    .how-step {
      background: var(--navy-2);
      padding: 2rem 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      transition: var(--transition);
    }

    .how-step:hover { background: var(--navy-3); }

    .how-step-num {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--green);
      letter-spacing: 0.1em;
    }

    .how-step-icon { font-size: 2rem; }

    .how-step-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.15rem;
    }

    .how-step-desc {
      font-size: 0.875rem;
      color: var(--text-2);
      line-height: 1.6;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       BROWSE PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .browse-header {
      padding: 2rem 2rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .browse-title {
      font-family: 'DM Serif Display', serif;
      font-size: 2rem;
    }

    .browse-subtitle {
      font-size: 0.9rem;
      color: var(--text-2);
      margin-top: 0.2rem;
    }

    /* Search bar */
    .search-bar {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      background: var(--navy-3);
      border: 1px solid var(--border-2);
      border-radius: 12px;
      padding: 0.6rem 1rem;
      min-width: 300px;
      transition: var(--transition);
    }

    .search-bar:focus-within {
      border-color: var(--green);
      box-shadow: 0 0 0 3px var(--green-glow);
    }

    .search-bar input {
      background: none;
      border: none;
      outline: none;
      color: var(--text-1);
      font-size: 0.9rem;
      width: 100%;
    }

    .search-bar input::placeholder { color: var(--text-3); }

    /* Category filters */
    .category-scroll {
      display: flex;
      gap: 0.5rem;
      padding: 0.75rem 2rem;
      overflow-x: auto;
      scrollbar-width: none;
      border-bottom: 1px solid var(--border);
    }

    .category-scroll::-webkit-scrollbar { display: none; }

    .cat-chip {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0.4rem 0.9rem;
      border-radius: 20px;
      border: 1px solid var(--border-2);
      background: var(--navy-3);
      font-size: 0.825rem;
      color: var(--text-2);
      white-space: nowrap;
      transition: var(--transition);
    }

    .cat-chip:hover, .cat-chip.active {
      border-color: var(--green);
      color: var(--green);
      background: var(--green-glow);
    }

    /* Listings grid */
    .listings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.25rem;
      padding: 1.5rem 2rem 4rem;
    }

    /* Listing card */
    .listing-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      transition: var(--transition);
      cursor: pointer;
      position: relative;
    }

    .listing-card::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: var(--radius);
      background: linear-gradient(135deg, var(--green-glow), transparent);
      opacity: 0;
      transition: var(--transition);
    }

    .listing-card:hover {
      border-color: rgba(0, 230, 118, 0.3);
      transform: translateY(-4px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.4), 0 0 0 1px rgba(0,230,118,0.1);
    }

    .listing-card:hover::before { opacity: 1; }

    .card-image {
      width: 100%;
      height: 200px;
      background: var(--navy-4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      position: relative;
      overflow: hidden;
    }

    .card-image-bg {
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, var(--navy-3), var(--navy-5));
    }

    .card-image-emoji {
      position: relative;
      z-index: 1;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.4));
    }

    .card-condition {
      position: absolute;
      top: 0.75rem;
      left: 0.75rem;
      padding: 0.25rem 0.6rem;
      border-radius: 6px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      z-index: 2;
    }

    .condition-new { background: rgba(0,230,118,0.2); color: var(--green); border: 1px solid rgba(0,230,118,0.3); }
    .condition-like_new { background: rgba(64,196,255,0.2); color: var(--blue-acc); border: 1px solid rgba(64,196,255,0.3); }
    .condition-good { background: rgba(255,171,64,0.2); color: var(--amber); border: 1px solid rgba(255,171,64,0.3); }
    .condition-fair { background: rgba(255,90,90,0.15); color: #ff6b6b; border: 1px solid rgba(255,90,90,0.3); }

    .card-eco-badge {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 0.25rem 0.6rem;
      border-radius: 6px;
      background: rgba(0,230,118,0.15);
      border: 1px solid rgba(0,230,118,0.25);
      font-size: 0.7rem;
      color: var(--green);
      font-weight: 600;
      z-index: 2;
      transition: var(--transition);
    }

    .listing-card:hover .card-eco-badge {
      background: rgba(0,230,118,0.3);
      box-shadow: 0 0 16px var(--green-glow);
    }

    .card-body { padding: 1.1rem; position: relative; z-index: 1; }

    .card-category {
      font-size: 0.72rem;
      color: var(--text-3);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.4rem;
    }

    .card-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.1rem;
      color: var(--text-1);
      line-height: 1.3;
      margin-bottom: 0.5rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .card-seller {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 0.9rem;
    }

    .seller-avatar {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--green), var(--blue-acc));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      color: var(--navy);
      font-weight: 700;
    }

    .seller-name {
      font-size: 0.78rem;
      color: var(--text-2);
    }

    .seller-rep {
      font-size: 0.72rem;
      color: var(--amber);
      margin-left: auto;
    }

    .card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-top: 0.9rem;
      border-top: 1px solid var(--border);
    }

    .card-price {
      font-family: 'DM Serif Display', serif;
      font-size: 1.5rem;
      color: var(--text-1);
    }

    .card-price-unit {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.75rem;
      color: var(--text-3);
      margin-left: 2px;
    }

    .card-price-inr {
      font-size: 0.75rem;
      color: var(--text-3);
      margin-top: 1px;
    }

    .card-buy-btn {
      padding: 0.5rem 1.1rem;
      background: var(--green);
      color: var(--navy);
      border-radius: 8px;
      font-size: 0.85rem;
      font-weight: 700;
      transition: var(--transition);
    }

    .card-buy-btn:hover {
      background: var(--green-dim);
      box-shadow: 0 4px 16px var(--green-glow);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SELL PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sell-page {
      max-width: 680px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    .sell-page h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }

    .sell-page .page-subtitle {
      color: var(--text-2);
      margin-bottom: 2.5rem;
      font-size: 0.95rem;
    }

    .form-section {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.75rem;
      margin-bottom: 1.25rem;
    }

    .form-section-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.2rem;
      margin-bottom: 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
      margin-bottom: 1rem;
    }

    .form-group:last-child { margin-bottom: 0; }

    .form-label {
      font-size: 0.82rem;
      color: var(--text-2);
      font-weight: 500;
      letter-spacing: 0.02em;
    }

    .form-input {
      background: var(--navy-3);
      border: 1px solid var(--border-2);
      border-radius: var(--radius-sm);
      padding: 0.65rem 0.9rem;
      color: var(--text-1);
      font-size: 0.9rem;
      outline: none;
      transition: var(--transition);
      width: 100%;
    }

    .form-input:focus {
      border-color: var(--green);
      box-shadow: 0 0 0 3px var(--green-glow);
      background: var(--navy-4);
    }

    .form-input::placeholder { color: var(--text-3); }

    select.form-input {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%235a6a84' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.9rem center;
      padding-right: 2.5rem;
      cursor: pointer;
    }

    select.form-input option { background: var(--navy-3); }

    textarea.form-input {
      resize: vertical;
      min-height: 100px;
    }

    /* Price preview */
    .price-preview {
      background: var(--navy-4);
      border: 1px solid rgba(0, 230, 118, 0.2);
      border-radius: var(--radius-sm);
      padding: 1rem;
      margin-top: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .price-preview-label {
      font-size: 0.8rem;
      color: var(--text-3);
    }

    .price-preview-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1.4rem;
      color: var(--green);
    }

    /* Eco estimate box */
    .eco-estimate {
      background: var(--navy-4);
      border: 1px solid rgba(0, 230, 118, 0.2);
      border-radius: var(--radius-sm);
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .eco-estimate-icon { font-size: 2rem; }

    .eco-estimate-title {
      font-size: 0.82rem;
      color: var(--text-3);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .eco-estimate-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1.25rem;
      color: var(--green);
    }

    .eco-estimate-sub {
      font-size: 0.78rem;
      color: var(--text-3);
    }

    .form-submit {
      width: 100%;
      padding: 1rem;
      background: var(--green);
      color: var(--navy);
      border-radius: var(--radius-sm);
      font-size: 1rem;
      font-weight: 700;
      transition: var(--transition);
      margin-top: 0.5rem;
    }

    .form-submit:hover {
      background: var(--green-dim);
      transform: translateY(-2px);
      box-shadow: 0 8px 32px var(--green-glow);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PROFILE / DASHBOARD PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .profile-page {
      max-width: 1000px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    .profile-hero {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 2rem;
      display: flex;
      align-items: center;
      gap: 2rem;
      margin-bottom: 1.5rem;
      position: relative;
      overflow: hidden;
    }

    .profile-hero::after {
      content: '';
      position: absolute;
      right: -60px;
      top: -60px;
      width: 240px;
      height: 240px;
      border-radius: 50%;
      background: radial-gradient(circle, var(--green-glow), transparent 70%);
      pointer-events: none;
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--green), var(--blue-acc));
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'DM Serif Display', serif;
      font-size: 2rem;
      color: var(--navy);
      flex-shrink: 0;
      border: 3px solid rgba(0,230,118,0.3);
    }

    .profile-info { flex: 1; }

    .profile-name {
      font-family: 'DM Serif Display', serif;
      font-size: 1.8rem;
      margin-bottom: 0.25rem;
    }

    .profile-email {
      font-size: 0.85rem;
      color: var(--text-2);
      font-family: 'JetBrains Mono', monospace;
      margin-bottom: 0.75rem;
    }

    .profile-badges {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .badge {
      padding: 0.25rem 0.65rem;
      border-radius: 6px;
      font-size: 0.72rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .badge-verified { background: var(--green-glow); color: var(--green); border: 1px solid rgba(0,230,118,0.3); }
    .badge-algo { background: rgba(64,196,255,0.15); color: var(--blue-acc); border: 1px solid rgba(64,196,255,0.3); }
    .badge-top { background: rgba(255,171,64,0.15); color: var(--amber); border: 1px solid rgba(255,171,64,0.3); }

    .profile-wallet {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-3);
      background: var(--navy-4);
      padding: 0.5rem 0.9rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Stats grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    @media (max-width: 640px) {
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .form-row { grid-template-columns: 1fr; }
      .listings-grid { grid-template-columns: 1fr; }
      .hero-stats { gap: 1.5rem; }
    }

    .stat-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.25rem 1.5rem;
      transition: var(--transition);
    }

    .stat-card:hover {
      border-color: var(--border-2);
      transform: translateY(-2px);
    }

    .stat-card-icon {
      font-size: 1.5rem;
      margin-bottom: 0.75rem;
    }

    .stat-card-value {
      font-family: 'DM Serif Display', serif;
      font-size: 2rem;
      color: var(--text-1);
    }

    .stat-card-value span { color: var(--green); }

    .stat-card-label {
      font-size: 0.78rem;
      color: var(--text-3);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-top: 0.25rem;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SUSTAINABILITY PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sustain-page {
      max-width: 1000px;
      margin: 0 auto;
      padding: 3rem 2rem;
    }

    .sustain-hero {
      text-align: center;
      padding: 3rem 0;
      position: relative;
    }

    .sustain-big-num {
      font-family: 'DM Serif Display', serif;
      font-size: clamp(4rem, 12vw, 9rem);
      color: var(--green);
      line-height: 1;
      text-shadow: 0 0 80px var(--green-glow);
    }

    .sustain-big-label {
      font-size: 1rem;
      color: var(--text-2);
      margin-top: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .sustain-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
      margin: 2rem 0;
    }

    @media (max-width: 768px) {
      .sustain-grid { grid-template-columns: 1fr; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
    }

    .sustain-card {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 1.75rem;
      text-align: center;
      transition: var(--transition);
    }

    .sustain-card:hover {
      border-color: rgba(0,230,118,0.3);
      transform: translateY(-3px);
      box-shadow: 0 12px 40px rgba(0,0,0,0.3);
    }

    .sustain-card-icon { font-size: 2.5rem; margin-bottom: 1rem; }

    .sustain-card-num {
      font-family: 'DM Serif Display', serif;
      font-size: 2.25rem;
      color: var(--text-1);
      margin-bottom: 0.3rem;
    }

    .sustain-card-desc {
      font-size: 0.875rem;
      color: var(--text-2);
      line-height: 1.5;
    }

    /* Category bars */
    .category-bars { margin-top: 2rem; }

    .cat-bar-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 0.9rem;
    }

    .cat-bar-label {
      font-size: 0.85rem;
      color: var(--text-2);
      width: 110px;
      flex-shrink: 0;
    }

    .cat-bar-track {
      flex: 1;
      height: 8px;
      background: var(--navy-4);
      border-radius: 4px;
      overflow: hidden;
    }

    .cat-bar-fill {
      height: 100%;
      border-radius: 4px;
      background: linear-gradient(90deg, var(--green), var(--blue-acc));
      transition: width 1s ease;
    }

    .cat-bar-val {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      color: var(--green);
      width: 60px;
      text-align: right;
    }

    /* Leaderboard */
    .leaderboard {
      background: var(--card-bg);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      margin-top: 2rem;
    }

    .lb-header {
      padding: 1.25rem 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .lb-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.3rem;
    }

    .lb-row {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.9rem 1.5rem;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .lb-row:last-child { border-bottom: none; }
    .lb-row:hover { background: var(--navy-3); }

    .lb-rank {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-3);
      width: 30px;
    }

    .lb-rank.gold { color: #ffd700; }
    .lb-rank.silver { color: #c0c0c0; }
    .lb-rank.bronze { color: #cd7f32; }

    .lb-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--green), var(--blue-acc));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      color: var(--navy);
      font-weight: 700;
    }

    .lb-name { flex: 1; font-size: 0.9rem; }

    .lb-college {
      font-size: 0.75rem;
      color: var(--text-3);
    }

    .lb-points {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--green);
      text-align: right;
    }

    .lb-co2 {
      font-size: 0.75rem;
      color: var(--text-3);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MODAL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(8px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: all;
    }

    .modal {
      background: var(--navy-2);
      border: 1px solid var(--border-2);
      border-radius: 20px;
      padding: 2rem;
      max-width: 480px;
      width: 100%;
      transform: scale(0.95);
      transition: transform 0.3s ease;
      position: relative;
    }

    .modal-overlay.open .modal { transform: scale(1); }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: var(--navy-4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      color: var(--text-2);
      transition: var(--transition);
    }

    .modal-close:hover { background: var(--navy-5); color: var(--text-1); }

    .modal-title {
      font-family: 'DM Serif Display', serif;
      font-size: 1.6rem;
      margin-bottom: 0.5rem;
    }

    .modal-sub {
      font-size: 0.875rem;
      color: var(--text-2);
      margin-bottom: 1.75rem;
    }

    /* Escrow status panel */
    .escrow-panel {
      background: var(--navy-4);
      border: 1px solid rgba(0,230,118,0.2);
      border-radius: var(--radius-sm);
      padding: 1rem 1.25rem;
      margin-bottom: 1.25rem;
    }

    .escrow-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .escrow-row:last-child { margin-bottom: 0; }

    .escrow-key {
      font-size: 0.78rem;
      color: var(--text-3);
    }

    .escrow-val {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.78rem;
      color: var(--text-1);
    }

    .escrow-val.green { color: var(--green); }
    .escrow-val.amber { color: var(--amber); }

    .modal-confirm-btn {
      width: 100%;
      padding: 0.9rem;
      background: var(--green);
      color: var(--navy);
      border-radius: var(--radius-sm);
      font-size: 0.95rem;
      font-weight: 700;
      transition: var(--transition);
      margin-top: 0.5rem;
    }

    .modal-confirm-btn:hover {
      background: var(--green-dim);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px var(--green-glow);
    }

    /* Success celebration */
    .success-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      backdrop-filter: blur(12px);
      z-index: 2000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
    }

    .success-overlay.show {
      opacity: 1;
      pointer-events: all;
    }

    .success-card {
      background: var(--navy-2);
      border: 1px solid rgba(0,230,118,0.4);
      border-radius: 24px;
      padding: 3rem 2.5rem;
      text-align: center;
      max-width: 420px;
      width: 90%;
      box-shadow: 0 0 80px var(--green-glow);
      transform: scale(0.8);
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .success-overlay.show .success-card { transform: scale(1); }

    .success-icon { font-size: 4rem; margin-bottom: 1rem; }

    .success-title {
      font-family: 'DM Serif Display', serif;
      font-size: 2rem;
      color: var(--green);
      margin-bottom: 0.5rem;
    }

    .success-msg {
      font-size: 0.95rem;
      color: var(--text-2);
      line-height: 1.6;
      margin-bottom: 1.5rem;
    }

    .success-points {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--green-glow);
      border: 1px solid rgba(0,230,118,0.3);
      border-radius: 12px;
      font-family: 'DM Serif Display', serif;
      font-size: 1.3rem;
      color: var(--green);
      margin-bottom: 1.5rem;
    }

    .success-close {
      padding: 0.75rem 2rem;
      background: var(--navy-5);
      color: var(--text-1);
      border-radius: 10px;
      font-size: 0.9rem;
      font-weight: 600;
      transition: var(--transition);
    }

    .success-close:hover { background: var(--navy-4); }

    /* Toast */
    .toast-container {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      z-index: 3000;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .toast {
      padding: 0.75rem 1.25rem;
      border-radius: 10px;
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      backdrop-filter: blur(12px);
      border: 1px solid var(--border-2);
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      animation: toastIn 0.3s ease;
      max-width: 320px;
    }

    @keyframes toastIn {
      from { opacity: 0; transform: translateX(20px); }
      to   { opacity: 1; transform: translateX(0); }
    }

    .toast-success { background: rgba(0,230,118,0.15); color: var(--green); border-color: rgba(0,230,118,0.3); }
    .toast-error { background: rgba(255,90,90,0.15); color: #ff6b6b; border-color: rgba(255,90,90,0.3); }
    .toast-info { background: rgba(64,196,255,0.15); color: var(--blue-acc); border-color: rgba(64,196,255,0.3); }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       AUTH MODAL (Login/Register)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .auth-tabs {
      display: flex;
      background: var(--navy-4);
      border-radius: 10px;
      padding: 4px;
      margin-bottom: 1.5rem;
    }

    .auth-tab {
      flex: 1;
      padding: 0.5rem;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-2);
      transition: var(--transition);
      text-align: center;
    }

    .auth-tab.active {
      background: var(--navy-2);
      color: var(--text-1);
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CHAT PAGE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .chat-page {
      display: grid;
      grid-template-columns: 280px 1fr;
      height: calc(100vh - 64px);
    }

    .chat-sidebar {
      border-right: 1px solid var(--border);
      overflow-y: auto;
    }

    .chat-sidebar-header {
      padding: 1.25rem;
      border-bottom: 1px solid var(--border);
      font-family: 'DM Serif Display', serif;
      font-size: 1.1rem;
    }

    .chat-thread {
      padding: 0.9rem 1.25rem;
      border-bottom: 1px solid var(--border);
      cursor: pointer;
      transition: var(--transition);
    }

    .chat-thread:hover, .chat-thread.active {
      background: var(--navy-3);
    }

    .chat-thread-title {
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: 0.2rem;
    }

    .chat-thread-preview {
      font-size: 0.78rem;
      color: var(--text-3);
    }

    .chat-thread-time {
      font-size: 0.7rem;
      color: var(--text-3);
      margin-top: 0.2rem;
    }

    .chat-main {
      display: flex;
      flex-direction: column;
    }

    .chat-main-header {
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .chat-msg {
      max-width: 70%;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .chat-msg.mine { align-self: flex-end; align-items: flex-end; }
    .chat-msg.theirs { align-self: flex-start; align-items: flex-start; }

    .chat-bubble {
      padding: 0.65rem 0.9rem;
      border-radius: 14px;
      font-size: 0.875rem;
      line-height: 1.5;
    }

    .chat-msg.mine .chat-bubble {
      background: var(--green);
      color: var(--navy);
      border-bottom-right-radius: 4px;
    }

    .chat-msg.theirs .chat-bubble {
      background: var(--navy-4);
      color: var(--text-1);
      border: 1px solid var(--border-2);
      border-bottom-left-radius: 4px;
    }

    .chat-bubble.offer {
      background: var(--navy-4);
      border: 1px solid rgba(255,171,64,0.4);
    }

    .chat-bubble.offer .offer-label {
      font-size: 0.7rem;
      color: var(--amber);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 0.25rem;
    }

    .chat-bubble.offer .offer-price {
      font-family: 'DM Serif Display', serif;
      font-size: 1.2rem;
      color: var(--amber);
    }

    .chat-msg-time {
      font-size: 0.68rem;
      color: var(--text-3);
      padding: 0 4px;
    }

    .chat-input-area {
      padding: 1rem 1.5rem;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 0.75rem;
      align-items: flex-end;
    }

    .chat-input-wrap {
      flex: 1;
      background: var(--navy-3);
      border: 1px solid var(--border-2);
      border-radius: 12px;
      padding: 0.65rem 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: var(--transition);
    }

    .chat-input-wrap:focus-within {
      border-color: var(--green);
    }

    .chat-input-wrap input {
      flex: 1;
      background: none;
      border: none;
      outline: none;
      color: var(--text-1);
      font-size: 0.875rem;
    }

    .chat-input-wrap input::placeholder { color: var(--text-3); }

    .chat-send-btn {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: var(--green);
      color: var(--navy);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      font-weight: 700;
      transition: var(--transition);
      flex-shrink: 0;
    }

    .chat-send-btn:hover {
      background: var(--green-dim);
      transform: scale(1.05);
    }

    /* Offer button */
    .offer-btn {
      padding: 0.35rem 0.75rem;
      border: 1px solid rgba(255,171,64,0.4);
      border-radius: 8px;
      font-size: 0.75rem;
      color: var(--amber);
      background: rgba(255,171,64,0.1);
      transition: var(--transition);
    }

    .offer-btn:hover {
      background: rgba(255,171,64,0.2);
    }
  </style>
</head>

<body>
<canvas id="bg-canvas"></canvas>

<div id="app">
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <nav>
    <div class="nav-logo" onclick="showPage('home')">
      <div class="nav-logo-icon">ğŸª</div>
      CampusBazaar
    </div>
    <div class="nav-links">
      <a class="nav-link active" onclick="showPage('home')" id="nav-home">Home</a>
      <a class="nav-link" onclick="showPage('browse')" id="nav-browse">Browse</a>
      <a class="nav-link" onclick="showPage('sell')" id="nav-sell">Sell</a>
      <a class="nav-link" onclick="showPage('chat')" id="nav-chat">Chat</a>
      <a class="nav-link" onclick="showPage('sustain')" id="nav-sustain">ğŸŒ± Impact</a>
    </div>
    <div class="nav-right">
      <div class="nav-wallet" onclick="showPage('profile')">
        <div class="wallet-dot"></div>
        <span id="nav-addr">ABC1...XY23</span>
      </div>
      <button class="btn-primary" onclick="openAuth()">Profile</button>
    </div>
  </nav>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-home" class="page active">
    <section class="hero">
      <div class="hero-badge">
        â›“ Powered by Algorand Blockchain
      </div>
      <h1>Buy. Sell. <em>Trust</em><br>the Contract.</h1>
      <p class="hero-sub">
        A campus-only decentralized marketplace where smart contract escrow
        guarantees every trade. Your campus. Your community. Zero trust required.
      </p>
      <div class="hero-cta">
        <button class="btn-hero btn-hero-solid" onclick="showPage('browse')">
          Browse Listings â†’
        </button>
        <button class="btn-hero btn-hero-outline" onclick="showPage('sell')">
          Sell an Item
        </button>
      </div>
      <div class="hero-stats">
        <div class="hero-stat">
          <div class="hero-stat-num"><span id="stat-listings">247</span></div>
          <div class="hero-stat-label">Active Listings</div>
        </div>
        <div class="hero-stat">
          <div class="hero-stat-num"><span id="stat-trades">1,842</span></div>
          <div class="hero-stat-label">Trades Completed</div>
        </div>
        <div class="hero-stat">
          <div class="hero-stat-num"><span id="stat-co2">4.2</span> <span style="font-size:1.5rem; color: var(--green)">t</span></div>
          <div class="hero-stat-label">COâ‚‚ Saved</div>
        </div>
        <div class="hero-stat">
          <div class="hero-stat-num"><span id="stat-users">512</span></div>
          <div class="hero-stat-label">Campus Members</div>
        </div>
      </div>
      <div class="scroll-hint">
        <span>Scroll to explore</span>
        <span class="scroll-arrow">â†“</span>
      </div>
    </section>

    <div class="how-strip">
      <div class="how-step">
        <div class="how-step-num">01 â€” LIST</div>
        <div class="how-step-icon">ğŸ“¦</div>
        <div class="how-step-title">List Your Item</div>
        <div class="how-step-desc">Post in 30 seconds. Smart contract escrow auto-deploys on Algorand testnet with a single click.</div>
      </div>
      <div class="how-step">
        <div class="how-step-num">02 â€” BUY</div>
        <div class="how-step-icon">ğŸ”’</div>
        <div class="how-step-title">Lock in Escrow</div>
        <div class="how-step-desc">Buyer sends ALGO. Funds are locked in the smart contract â€” nobody can access them yet.</div>
      </div>
      <div class="how-step">
        <div class="how-step-num">03 â€” CONFIRM</div>
        <div class="how-step-icon">âœ…</div>
        <div class="how-step-title">Confirm Delivery</div>
        <div class="how-step-desc">Once you receive the item, tap confirm. ALGO releases instantly to the seller. No middlemen.</div>
      </div>
      <div class="how-step">
        <div class="how-step-num">04 â€” EARN</div>
        <div class="how-step-icon">ğŸŒ±</div>
        <div class="how-step-title">Earn Eco-Points</div>
        <div class="how-step-desc">Every trade saves COâ‚‚ and earns on-chain eco-points. Climb the campus sustainability leaderboard.</div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BROWSE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-browse" class="page">
    <div class="browse-header">
      <div>
        <h1 class="browse-title">Marketplace</h1>
        <p class="browse-subtitle">247 items available on campus</p>
      </div>
      <div class="search-bar">
        <span style="color:var(--text-3)">ğŸ”</span>
        <input id="search-input" type="text" placeholder="Search textbooks, cycles, electronicsâ€¦" oninput="filterListings()" />
      </div>
    </div>

    <div class="category-scroll">
      <button class="cat-chip active" onclick="filterCat('all', this)">âœ¨ All</button>
      <button class="cat-chip" onclick="filterCat('books', this)">ğŸ“š Books</button>
      <button class="cat-chip" onclick="filterCat('cycles', this)">ğŸš² Cycles</button>
      <button class="cat-chip" onclick="filterCat('electronics', this)">ğŸ’» Electronics</button>
      <button class="cat-chip" onclick="filterCat('furniture', this)">ğŸª‘ Furniture</button>
      <button class="cat-chip" onclick="filterCat('clothing', this)">ğŸ‘• Clothing</button>
      <button class="cat-chip" onclick="filterCat('sports', this)">âš½ Sports</button>
    </div>

    <div class="listings-grid" id="listings-grid"></div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SELL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-sell" class="page">
    <div class="sell-page">
      <h1>List an Item</h1>
      <p class="page-subtitle">Your listing deploys a smart contract escrow on Algorand. It takes about 3 seconds.</p>

      <div class="form-section">
        <div class="form-section-title">ğŸ“ Item Details</div>
        <div class="form-group">
          <label class="form-label">Item Title</label>
          <input class="form-input" type="text" placeholder="e.g. Resnick Halliday Physics Vol 1" id="sell-title" />
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Category</label>
            <select class="form-input" id="sell-category" onchange="updateEcoEstimate()">
              <option value="">Select category</option>
              <option value="books">ğŸ“š Books</option>
              <option value="cycles">ğŸš² Cycles & Scooters</option>
              <option value="electronics">ğŸ’» Electronics</option>
              <option value="furniture">ğŸª‘ Furniture</option>
              <option value="clothing">ğŸ‘• Clothing</option>
              <option value="sports">âš½ Sports Equipment</option>
              <option value="other">ğŸ“¦ Other</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Condition</label>
            <select class="form-input" id="sell-condition">
              <option value="new">âœ¨ New</option>
              <option value="like_new">ğŸŒŸ Like New</option>
              <option value="good" selected>ğŸ‘ Good</option>
              <option value="fair">ğŸ”§ Fair</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">Description</label>
          <textarea class="form-input" placeholder="Describe condition, edition, any wear and tearâ€¦" id="sell-desc"></textarea>
        </div>
      </div>

      <div class="form-section">
        <div class="form-section-title">ğŸ’° Pricing</div>
        <div class="form-group">
          <label class="form-label">Price (ALGO)</label>
          <input class="form-input" type="number" placeholder="e.g. 5" id="sell-price" min="1" oninput="updatePricePreview()" />
        </div>
        <div class="price-preview" id="price-preview" style="display:none">
          <div>
            <div class="price-preview-label">Escrow Amount</div>
            <div style="font-size:0.75rem;color:var(--text-3);margin-top:2px">Buyer pays Â· 1% platform fee on release</div>
          </div>
          <div class="price-preview-value" id="price-preview-val">5.00 ALGO</div>
        </div>
      </div>

      <div class="form-section">
        <div class="form-section-title">ğŸŒ± Sustainability Impact</div>
        <div class="eco-estimate" id="eco-estimate">
          <div class="eco-estimate-icon">ğŸŒ¿</div>
          <div>
            <div class="eco-estimate-title">Select a category to see impact</div>
            <div class="eco-estimate-value" id="eco-co2">â€”</div>
            <div class="eco-estimate-sub" id="eco-points-preview">Choose a category above</div>
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="form-section-title">â›“ Blockchain Escrow</div>
        <div style="background:var(--navy-4);border-radius:var(--radius-sm);padding:1rem;font-size:0.82rem;color:var(--text-2);line-height:1.7;border:1px solid var(--border)">
          Listing this item will deploy a smart contract on <span style="color:var(--blue-acc)">Algorand Testnet</span>.<br>
          The contract will hold buyer's funds until they confirm delivery.<br>
          You receive <strong style="color:var(--green)">99% of the price</strong> â€” 1% goes to the platform.<br>
          Funds are automatically refunded if delivery isn't confirmed within 55 minutes.
        </div>
      </div>

      <button class="form-submit" onclick="submitListing()">
        ğŸš€ Deploy Escrow & List Item
      </button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHAT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-chat" class="page">
    <div class="chat-page">
      <div class="chat-sidebar">
        <div class="chat-sidebar-header">ğŸ’¬ Negotiations</div>
        <div id="chat-threads"></div>
      </div>
      <div class="chat-main">
        <div class="chat-main-header">
          <div>
            <div style="font-weight:600" id="chat-item-title">DSP Textbook â€” Proakis</div>
            <div style="font-size:0.78rem;color:var(--text-3)">Listed at <span style="color:var(--amber)" id="chat-item-price">8 ALGO</span></div>
          </div>
          <button class="offer-btn" onclick="openOfferModal()" style="margin-left:auto">
            ğŸ’° Make Offer
          </button>
          <button class="btn-primary" style="font-size:0.8rem;padding:0.4rem 0.9rem" onclick="openBuyModal()">Buy Now</button>
        </div>
        <div class="chat-messages" id="chat-messages"></div>
        <div class="chat-input-area">
          <div class="chat-input-wrap">
            <input type="text" id="chat-input" placeholder="Ask about the item, negotiateâ€¦" onkeydown="if(event.key==='Enter')sendMsg()" />
          </div>
          <button class="chat-send-btn" onclick="sendMsg()">â†’</button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUSTAINABILITY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-sustain" class="page">
    <div class="sustain-page">
      <div class="sustain-hero">
        <div style="font-size:0.8rem;color:var(--text-3);text-transform:uppercase;letter-spacing:0.12em;margin-bottom:1rem">Campus Impact This Month</div>
        <div class="sustain-big-num" id="sustain-co2">4,219</div>
        <div class="sustain-big-label">Kilograms of COâ‚‚ Saved</div>
        <div style="margin-top:1rem;color:var(--text-2);font-size:0.9rem">Equivalent to planting <span style="color:var(--green);font-weight:600">201 trees</span> or not driving <span style="color:var(--green);font-weight:600">24,673 km</span></div>
      </div>

      <div class="sustain-grid">
        <div class="sustain-card">
          <div class="sustain-card-icon">ğŸŒ³</div>
          <div class="sustain-card-num">201</div>
          <div class="sustain-card-desc">Trees equivalent â€” the COâ‚‚ our campus trades absorb in a year</div>
        </div>
        <div class="sustain-card">
          <div class="sustain-card-icon">ğŸš—</div>
          <div class="sustain-card-num">24,673</div>
          <div class="sustain-card-desc">Kilometres of car travel our campus collectively avoided</div>
        </div>
        <div class="sustain-card">
          <div class="sustain-card-icon">ğŸ“±</div>
          <div class="sustain-card-num">612,000</div>
          <div class="sustain-card-desc">Smartphone charges â€” the energy we saved by reusing items</div>
        </div>
      </div>

      <h2 style="font-size:1.5rem;margin-bottom:1rem">Impact by Category</h2>
      <div class="category-bars" id="cat-bars"></div>

      <div class="leaderboard" style="margin-top:2rem">
        <div class="lb-header">
          <div class="lb-title">ğŸ† Eco-Points Leaderboard</div>
          <span style="font-size:0.78rem;color:var(--text-3)">This semester</span>
        </div>
        <div id="leaderboard-rows"></div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PROFILE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="page-profile" class="page">
    <div class="profile-page">
      <div class="profile-hero">
        <div class="profile-avatar" id="profile-avatar">A</div>
        <div class="profile-info">
          <div class="profile-name" id="profile-name">Aanan</div>
          <div class="profile-email" id="profile-email">aanan@iitbombay.ac.in</div>
          <div class="profile-badges">
            <span class="badge badge-verified">âœ“ Verified Student</span>
            <span class="badge badge-algo">â›“ Algorand Testnet</span>
            <span class="badge badge-top">ğŸ† Top Seller</span>
          </div>
        </div>
        <div class="profile-wallet">
          ğŸ”‘ <span id="profile-wallet-addr">ABC1â€¦XY23</span>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-card-icon">ğŸ“¦</div>
          <div class="stat-card-value"><span>12</span></div>
          <div class="stat-card-label">Trades Done</div>
        </div>
        <div class="stat-card">
          <div class="stat-card-icon">ğŸŒ±</div>
          <div class="stat-card-value"><span>340</span></div>
          <div class="stat-card-label">Eco Points</div>
        </div>
        <div class="stat-card">
          <div class="stat-card-icon">ğŸŒ¿</div>
          <div class="stat-card-value"><span>8.4</span> <span style="font-size:1.2rem;color:var(--text-2)">kg</span></div>
          <div class="stat-card-label">COâ‚‚ Saved</div>
        </div>
        <div class="stat-card">
          <div class="stat-card-icon">â­</div>
          <div class="stat-card-value"><span>92</span></div>
          <div class="stat-card-label">Reputation</div>
        </div>
      </div>

      <div style="background:var(--card-bg);border:1px solid var(--border);border-radius:var(--radius);padding:1.5rem;margin-top:1rem">
        <div style="font-family:'DM Serif Display',serif;font-size:1.2rem;margin-bottom:1rem">Your Active Listings</div>
        <div id="my-listings-mini"></div>
      </div>
    </div>
  </div>

</div><!-- end #app -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BUY MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="buy-modal">
  <div class="modal">
    <button class="modal-close" onclick="closeBuyModal()">âœ•</button>
    <div class="modal-title" id="modal-item-title">DSP Textbook</div>
    <div class="modal-sub">Smart contract escrow â€” funds locked until you confirm delivery</div>

    <div class="escrow-panel">
      <div class="escrow-row">
        <span class="escrow-key">Escrow Contract</span>
        <span class="escrow-val green">ALGO Testnet</span>
      </div>
      <div class="escrow-row">
        <span class="escrow-key">Item Price</span>
        <span class="escrow-val" id="modal-price">8.00 ALGO</span>
      </div>
      <div class="escrow-row">
        <span class="escrow-key">Platform Fee (1%)</span>
        <span class="escrow-val" id="modal-fee">0.08 ALGO</span>
      </div>
      <div class="escrow-row" style="padding-top:0.5rem;border-top:1px solid var(--border)">
        <span class="escrow-key" style="color:var(--text-1)">Total to Lock</span>
        <span class="escrow-val amber" id="modal-total">8.00 ALGO</span>
      </div>
    </div>
    <div style="font-size:0.8rem;color:var(--text-3);margin-bottom:1rem;line-height:1.6">
      ğŸ”’ Funds will be locked in escrow. You'll confirm delivery after receiving the item, which releases payment to the seller.
    </div>
    <button class="modal-confirm-btn" onclick="confirmPurchase()">
      ğŸ”’ Fund Escrow with Pera Wallet
    </button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTH MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="auth-modal">
  <div class="modal">
    <button class="modal-close" onclick="document.getElementById('auth-modal').classList.remove('open')">âœ•</button>
    <div class="auth-tabs">
      <button class="auth-tab active" id="tab-login" onclick="switchAuthTab('login')">Login</button>
      <button class="auth-tab" id="tab-register" onclick="switchAuthTab('register')">Register</button>
    </div>
    <div id="auth-login-form">
      <div class="form-group"><label class="form-label">College Email</label><input class="form-input" type="email" placeholder="yourname@college.ac.in" id="login-email" /></div>
      <div class="form-group"><label class="form-label">Password</label><input class="form-input" type="password" id="login-pw" /></div>
      <button class="form-submit" style="margin-top:0.75rem" onclick="doLogin()">Login to CampusBazaar</button>
    </div>
    <div id="auth-register-form" style="display:none">
      <div class="form-group"><label class="form-label">Full Name</label><input class="form-input" type="text" placeholder="Your name" id="reg-name" /></div>
      <div class="form-group"><label class="form-label">College Email</label><input class="form-input" type="email" placeholder="yourname@college.ac.in" id="reg-email" /></div>
      <div class="form-group"><label class="form-label">Password</label><input class="form-input" type="password" id="reg-pw" /></div>
      <div class="form-group"><label class="form-label">Algorand Wallet Address</label><input class="form-input" type="text" placeholder="58-character address" id="reg-wallet" /></div>
      <button class="form-submit" style="margin-top:0.75rem" onclick="doRegister()">Create Account</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUCCESS OVERLAY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="success-overlay" id="success-overlay">
  <div class="success-card">
    <div class="success-icon">ğŸŒ±</div>
    <div class="success-title">Trade Complete!</div>
    <div class="success-msg" id="success-msg">You saved 0.8 kg of COâ‚‚ â€” equivalent to charging 97 smartphones!</div>
    <div class="success-points" id="success-pts">+20 Eco-Points Earned</div>
    <button class="success-close" onclick="closeSuccess()">Awesome, thanks! â†’</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TOASTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="toast-container" id="toasts"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARTICLE CANVAS BACKGROUND
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('bg-canvas');
const ctx = canvas.getContext('2d');
let particles = [];

function resizeCanvas() {
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight;
}

function createParticles() {
  particles = [];
  const count = Math.floor((canvas.width * canvas.height) / 18000);
  for (let i = 0; i < count; i++) {
    particles.push({
      x:    Math.random() * canvas.width,
      y:    Math.random() * canvas.height,
      r:    Math.random() * 1.5 + 0.3,
      vx:   (Math.random() - 0.5) * 0.25,
      vy:   (Math.random() - 0.5) * 0.25,
      life: Math.random(),
      hue:  Math.random() > 0.5 ? 'rgba(0,230,118,' : 'rgba(64,196,255,'
    });
  }
}

function drawParticles() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(p => {
    p.life += 0.003;
    p.x += p.vx;
    p.y += p.vy;
    if (p.x < 0) p.x = canvas.width;
    if (p.x > canvas.width)  p.x = 0;
    if (p.y < 0) p.y = canvas.height;
    if (p.y > canvas.height) p.y = 0;
    const a = Math.abs(Math.sin(p.life)) * 0.5 + 0.1;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
    ctx.fillStyle = p.hue + a + ')';
    ctx.fill();
  });

  // Draw subtle connecting lines
  for (let i = 0; i < particles.length; i++) {
    for (let j = i + 1; j < particles.length; j++) {
      const dx = particles[i].x - particles[j].x;
      const dy = particles[i].y - particles[j].y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if (dist < 100) {
        ctx.beginPath();
        ctx.moveTo(particles[i].x, particles[i].y);
        ctx.lineTo(particles[j].x, particles[j].y);
        ctx.strokeStyle = `rgba(0,230,118,${0.08 * (1 - dist/100)})`;
        ctx.lineWidth = 0.5;
        ctx.stroke();
      }
    }
  }
  requestAnimationFrame(drawParticles);
}

resizeCanvas();
createParticles();
drawParticles();
window.addEventListener('resize', () => { resizeCanvas(); createParticles(); });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CO2_MAP   = { books:800, cycles:30000, electronics:15000, furniture:12000, clothing:2000, sports:3000, other:1000 };
const ALGO_INR  = 12.5; // approximate

const DEMO_LISTINGS = [
  { id:'1', title:'DSP Textbook â€” Proakis (4th Ed)', category:'books', condition:'good', price:8, co2:800, eco:20, seller:'Rahul S.', rep:4.8, emoji:'ğŸ“š', desc:'Used for 1 semester. Some pencil marks but all pages intact.' },
  { id:'2', title:'Hero Sprint Cycle (2023)', category:'cycles', condition:'like_new', price:85, co2:30000, eco:150, seller:'Priya M.', rep:5.0, emoji:'ğŸš²', desc:'Barely used. Shifting gears work perfectly. Includes lock.' },
  { id:'3', title:'Casio FX-991EX Calculator', category:'electronics', condition:'new', price:12, co2:500, eco:30, seller:'Arjun K.', rep:4.5, emoji:'ğŸ§®', desc:'Bought extra, never used. Still in original box with warranty.' },
  { id:'4', title:'Engineering Drawing Kit', category:'other', condition:'good', price:5, co2:300, eco:10, seller:'Sneha R.', rep:4.7, emoji:'ğŸ“', desc:'Full kit. Compass, set squares, mini drafter all included.' },
  { id:'5', title:'Thermodynamics (Cengel)', category:'books', condition:'fair', price:6, co2:800, eco:20, seller:'Dev P.', rep:4.3, emoji:'ğŸ“–', desc:'Lots of helpful margin notes. Cover has tape on spine.' },
  { id:'6', title:'Study Table Lamp', category:'furniture', condition:'like_new', price:10, co2:4000, eco:35, seller:'Ananya T.', rep:4.9, emoji:'ğŸ’¡', desc:'LED, warm+cool light. USB port on base. Works perfectly.' },
  { id:'7', title:'Cricket Bat â€” SG Players', category:'sports', condition:'good', price:20, co2:3000, eco:25, seller:'Vikram B.', rep:4.6, emoji:'ğŸ', desc:'Oiled and ready. Played 2 seasons. Clean middle section.' },
  { id:'8', title:'Laptop Stand + Keyboard', category:'electronics', condition:'like_new', price:18, co2:8000, eco:50, seller:'Tanya J.', rep:4.8, emoji:'ğŸ’»', desc:'Aluminum stand, wireless keyboard included. Used 3 months.' },
  { id:'9', title:'Organic Chemistry (Morrison & Boyd)', category:'books', condition:'good', price:7, co2:800, eco:20, seller:'Karan M.', rep:4.4, emoji:'âš—ï¸', desc:'Classic chem textbook. Highlighted chapters 1-15.' },
];

const LEADERBOARD_DATA = [
  { name:'Priya M.',    college:'IIT Bombay',   points:890, co2:48.2, initial:'P' },
  { name:'Rahul S.',    college:'IIT Bombay',   points:720, co2:31.5, initial:'R' },
  { name:'Arjun K.',    college:'IIT Bombay',   points:610, co2:28.3, initial:'A' },
  { name:'Sneha R.',    college:'IIT Bombay',   points:540, co2:22.1, initial:'S' },
  { name:'Dev P.',      college:'IIT Bombay',   points:480, co2:18.7, initial:'D' },
  { name:'Ananya T.',   college:'IIT Bombay',   points:420, co2:16.2, initial:'A' },
];

const CAT_CO2 = [
  { label:'ğŸš² Cycles',       val:240, max:240 },
  { label:'ğŸ’» Electronics',  val:180, max:240 },
  { label:'ğŸª‘ Furniture',    val:120, max:240 },
  { label:'âš½ Sports',       val:80,  max:240 },
  { label:'ğŸ“š Books',        val:60,  max:240 },
  { label:'ğŸ‘• Clothing',     val:40,  max:240 },
];

let currentCat = 'all';
let buyingListing = null;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAGE NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPage(name) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  const navEl = document.getElementById('nav-' + name);
  if (navEl) navEl.classList.add('active');

  if (name === 'browse') renderListings();
  if (name === 'sustain') renderSustain();
  if (name === 'chat') renderChat();
  if (name === 'profile') renderProfile();

  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LISTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderListings(cat = currentCat) {
  const search = (document.getElementById('search-input') || {}).value || '';
  const grid   = document.getElementById('listings-grid');
  grid.innerHTML = '';

  const filtered = DEMO_LISTINGS.filter(l =>
    (cat === 'all' || l.category === cat) &&
    (l.title.toLowerCase().includes(search.toLowerCase()) || l.category.includes(search.toLowerCase()))
  );

  if (!filtered.length) {
    grid.innerHTML = `<div style="grid-column:1/-1;text-align:center;padding:4rem;color:var(--text-3)">
      <div style="font-size:3rem;margin-bottom:1rem">ğŸ”</div>
      <div style="font-size:1.1rem">No listings found</div>
    </div>`;
    return;
  }

  filtered.forEach((item, i) => {
    const condClass = 'condition-' + item.condition;
    const condLabel = { new:'New', like_new:'Like New', good:'Good', fair:'Fair' }[item.condition];
    const inr = Math.round(item.price * ALGO_INR);

    const card = document.createElement('div');
    card.className = 'listing-card';
    card.style.animationDelay = (i * 0.06) + 's';
    card.innerHTML = `
      <div class="card-image">
        <div class="card-image-bg"></div>
        <div class="card-image-emoji">${item.emoji}</div>
        <span class="card-condition ${condClass}">${condLabel}</span>
        <div class="card-eco-badge">ğŸŒ± ${(item.co2/1000).toFixed(1)}kg COâ‚‚</div>
      </div>
      <div class="card-body">
        <div class="card-category">${item.category}</div>
        <div class="card-title">${item.title}</div>
        <div class="card-seller">
          <div class="seller-avatar">${item.seller[0]}</div>
          <span class="seller-name">${item.seller}</span>
          <span class="seller-rep">â˜… ${item.rep}</span>
        </div>
        <div class="card-footer">
          <div>
            <div class="card-price">${item.price}<span class="card-price-unit">ALGO</span></div>
            <div class="card-price-inr">â‰ˆ â‚¹${inr.toLocaleString()}</div>
          </div>
          <button class="card-buy-btn" onclick="openBuyModal(event,'${item.id}')">Buy Now</button>
        </div>
      </div>`;
    grid.appendChild(card);
  });
}

function filterCat(cat, el) {
  currentCat = cat;
  document.querySelectorAll('.cat-chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  renderListings(cat);
}

function filterListings() { renderListings(currentCat); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SELL FORM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updatePricePreview() {
  const val = parseFloat(document.getElementById('sell-price').value);
  const preview = document.getElementById('price-preview');
  if (val && val > 0) {
    preview.style.display = 'flex';
    document.getElementById('price-preview-val').textContent = val.toFixed(2) + ' ALGO';
  } else {
    preview.style.display = 'none';
  }
}

function updateEcoEstimate() {
  const cat = document.getElementById('sell-category').value;
  if (!cat) return;
  const co2 = CO2_MAP[cat] || 1000;
  const pts = Math.round(co2 / 40);
  document.getElementById('eco-co2').textContent = (co2 / 1000).toFixed(1) + ' kg COâ‚‚ saved';
  document.getElementById('eco-points-preview').textContent = `+${pts} eco-points Â· 1 point per 40g COâ‚‚`;
}

function submitListing() {
  const title = document.getElementById('sell-title').value.trim();
  const price = parseFloat(document.getElementById('sell-price').value);
  const cat   = document.getElementById('sell-category').value;

  if (!title) return showToast('Please enter an item title', 'error');
  if (!price || price < 1) return showToast('Minimum price is 1 ALGO', 'error');
  if (!cat)   return showToast('Please select a category', 'error');

  showToast('â›“ Deploying escrow on Algorand testnetâ€¦', 'info');
  setTimeout(() => {
    showToast('âœ… Listing live! Contract deployed.', 'success');
    DEMO_LISTINGS.unshift({
      id: String(Date.now()),
      title, category: cat, condition: document.getElementById('sell-condition').value,
      price, co2: CO2_MAP[cat] || 1000,
      eco: Math.round((CO2_MAP[cat] || 1000) / 40),
      seller: 'You', rep: 5.0, emoji: 'ğŸ“¦',
      desc: document.getElementById('sell-desc').value,
    });
    showPage('browse');
  }, 2000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BUY MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openBuyModal(event, id) {
  if (event) event.stopPropagation();
  const item = id ? DEMO_LISTINGS.find(l => l.id === id) : DEMO_LISTINGS[0];
  if (!item) return;
  buyingListing = item;
  document.getElementById('modal-item-title').textContent = item.title;
  document.getElementById('modal-price').textContent  = item.price.toFixed(2) + ' ALGO';
  document.getElementById('modal-fee').textContent    = (item.price * 0.01).toFixed(3) + ' ALGO';
  document.getElementById('modal-total').textContent  = item.price.toFixed(2) + ' ALGO';
  document.getElementById('buy-modal').classList.add('open');
}

function closeBuyModal() {
  document.getElementById('buy-modal').classList.remove('open');
}

function confirmPurchase() {
  closeBuyModal();
  showToast('â›“ Signing transaction with Pera Walletâ€¦', 'info');
  setTimeout(() => {
    showToast('ğŸ”’ ALGO locked in escrow contract', 'success');
    setTimeout(() => showDeliveryConfirm(), 2000);
  }, 1800);
}

function showDeliveryConfirm() {
  if (!buyingListing) return;
  const co2kg = (buyingListing.co2 / 1000).toFixed(1);
  const msgs = {
    books:       `You saved ${co2kg} kg COâ‚‚ â€” equivalent to not printing 4 textbooks! ğŸ“š`,
    cycles:      `You saved ${co2kg} kg COâ‚‚ â€” like skipping ${Math.round(buyingListing.co2/171)} km of car travel! ğŸš²`,
    electronics: `You saved ${co2kg} kg COâ‚‚ â€” equivalent to charging ${Math.round(buyingListing.co2*0.065)} smartphones! ğŸ’»`,
    furniture:   `You saved ${co2kg} kg COâ‚‚ â€” like keeping ${Math.round(buyingListing.co2/21000)} trees alive for a year! ğŸŒ³`,
    default:     `You saved ${co2kg} kg COâ‚‚ by choosing to reuse this item! ğŸŒ±`,
  };
  const msg = msgs[buyingListing.category] || msgs.default;
  document.getElementById('success-msg').textContent = msg;
  document.getElementById('success-pts').textContent = `+${buyingListing.eco} Eco-Points Earned`;
  document.getElementById('success-overlay').classList.add('show');
}

function closeSuccess() {
  document.getElementById('success-overlay').classList.remove('show');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHAT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const chatData = [
  {
    id:'1', title:'DSP Textbook â€” Proakis', price:'8 ALGO',
    msgs: [
      { mine:false, text:'Hi! Is the textbook still available?', time:'2:14 PM' },
      { mine:true,  text:'Yes it is! Great condition, just a few pencil marks.', time:'2:16 PM' },
      { mine:false, text:'Could you do 6 ALGO? I\'m a bit short this month.', time:'2:17 PM', offer:{ price:'6.00 ALGO' }},
      { mine:true,  text:'I can do 7 ALGO, that\'s my best. It\s barely used!', time:'2:19 PM' },
      { mine:false, text:'Deal! I\'ll pay 7 ALGO. Can we meet at the library today?', time:'2:21 PM' },
    ]
  },
  {
    id:'2', title:'Hero Sprint Cycle', price:'85 ALGO',
    msgs: [
      { mine:false, text:'Does the cycle come with a basket?', time:'11:30 AM' },
      { mine:true,  text:'No basket, but it includes the original lock and key!', time:'11:32 AM' },
    ]
  },
];

let activeChat = 0;

function renderChat() {
  const threads = document.getElementById('chat-threads');
  threads.innerHTML = chatData.map((c, i) => `
    <div class="chat-thread ${i === activeChat ? 'active' : ''}" onclick="switchChat(${i})">
      <div class="chat-thread-title">${c.title}</div>
      <div class="chat-thread-preview">${c.msgs[c.msgs.length-1].text.slice(0,45)}â€¦</div>
      <div class="chat-thread-time">${c.msgs[c.msgs.length-1].time}</div>
    </div>`).join('');
  loadChatMessages(activeChat);
}

function switchChat(i) {
  activeChat = i;
  document.getElementById('chat-item-title').textContent  = chatData[i].title;
  document.getElementById('chat-item-price').textContent  = chatData[i].price;
  renderChat();
}

function loadChatMessages(i) {
  const msgs = document.getElementById('chat-messages');
  msgs.innerHTML = chatData[i].msgs.map(m => {
    if (m.offer) return `
      <div class="chat-msg ${m.mine ? 'mine' : 'theirs'}">
        <div class="chat-bubble offer">
          <div class="offer-label">ğŸ’° Price Offer</div>
          <div class="offer-price">${m.offer.price}</div>
        </div>
        <div class="chat-msg-time">${m.time}</div>
      </div>`;
    return `
      <div class="chat-msg ${m.mine ? 'mine' : 'theirs'}">
        <div class="chat-bubble">${m.text}</div>
        <div class="chat-msg-time">${m.time}</div>
      </div>`;
  }).join('');
  msgs.scrollTop = msgs.scrollHeight;
}

function sendMsg() {
  const input = document.getElementById('chat-input');
  const text  = input.value.trim();
  if (!text) return;
  const now = new Date();
  const time = now.toLocaleTimeString('en-US', { hour:'2-digit', minute:'2-digit' });
  chatData[activeChat].msgs.push({ mine:true, text, time });
  input.value = '';
  loadChatMessages(activeChat);
  showToast('Message sent', 'success');
}

function openOfferModal() {
  const price = prompt('Enter your offer price in ALGO:');
  if (price && !isNaN(parseFloat(price))) {
    const now  = new Date();
    const time = now.toLocaleTimeString('en-US', { hour:'2-digit', minute:'2-digit' });
    chatData[activeChat].msgs.push({ mine:true, text:'', time, offer:{ price: parseFloat(price).toFixed(2) + ' ALGO' } });
    loadChatMessages(activeChat);
    showToast(`Offer of ${price} ALGO sent!`, 'success');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUSTAINABILITY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderSustain() {
  // Animate the big number
  const target = 4219;
  const el = document.getElementById('sustain-co2');
  let current = 0;
  const step = Math.ceil(target / 60);
  const timer = setInterval(() => {
    current = Math.min(current + step, target);
    el.textContent = current.toLocaleString();
    if (current >= target) clearInterval(timer);
  }, 16);

  // Category bars
  const barsEl = document.getElementById('cat-bars');
  barsEl.innerHTML = CAT_CO2.map(c => `
    <div class="cat-bar-row">
      <div class="cat-bar-label">${c.label}</div>
      <div class="cat-bar-track">
        <div class="cat-bar-fill" style="width:0%" data-target="${Math.round(c.val/c.max*100)}%"></div>
      </div>
      <div class="cat-bar-val">${c.val} kg</div>
    </div>`).join('');

  // Animate bars
  requestAnimationFrame(() => {
    document.querySelectorAll('.cat-bar-fill').forEach(b => {
      b.style.width = b.dataset.target;
    });
  });

  // Leaderboard
  const lb = document.getElementById('leaderboard-rows');
  const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'];
  const rankClass = ['gold', 'silver', 'bronze'];
  lb.innerHTML = LEADERBOARD_DATA.map((u, i) => `
    <div class="lb-row">
      <div class="lb-rank ${rankClass[i] || ''}">${medals[i] || '#' + (i+1)}</div>
      <div class="lb-avatar">${u.initial}</div>
      <div class="lb-name">
        <div>${u.name}</div>
        <div class="lb-college">${u.college}</div>
      </div>
      <div style="text-align:right">
        <div class="lb-points">ğŸŒ± ${u.points} pts</div>
        <div class="lb-co2">${u.co2} kg COâ‚‚</div>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PROFILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderProfile() {
  const myListings = document.getElementById('my-listings-mini');
  const myItems = DEMO_LISTINGS.filter(l => l.seller === 'You' || l.seller === 'Rahul S.').slice(0, 3);
  if (!myItems.length) {
    myListings.innerHTML = `<div style="color:var(--text-3);font-size:0.875rem;text-align:center;padding:1.5rem">You have no active listings. <a onclick="showPage('sell')" style="color:var(--green);cursor:pointer">List an item â†’</a></div>`;
    return;
  }
  myListings.innerHTML = myItems.map(item => `
    <div style="display:flex;align-items:center;gap:1rem;padding:0.75rem 0;border-bottom:1px solid var(--border)">
      <div style="font-size:1.5rem">${item.emoji}</div>
      <div style="flex:1">
        <div style="font-size:0.875rem;font-weight:500">${item.title}</div>
        <div style="font-size:0.75rem;color:var(--text-3)">${item.category} Â· ${item.condition}</div>
      </div>
      <div style="font-family:'JetBrains Mono',monospace;font-size:0.875rem;color:var(--green)">${item.price} ALGO</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openAuth() {
  document.getElementById('auth-modal').classList.add('open');
}

function switchAuthTab(tab) {
  document.getElementById('auth-login-form').style.display    = tab === 'login'    ? 'block' : 'none';
  document.getElementById('auth-register-form').style.display = tab === 'register' ? 'block' : 'none';
  document.getElementById('tab-login').classList.toggle('active',    tab === 'login');
  document.getElementById('tab-register').classList.toggle('active', tab === 'register');
}

function doLogin() {
  const email = document.getElementById('login-email').value;
  if (!email.includes('@')) return showToast('Enter a valid college email', 'error');
  document.getElementById('auth-modal').classList.remove('open');
  showToast('âœ… Logged in successfully!', 'success');
  showPage('profile');
}

function doRegister() {
  const name   = document.getElementById('reg-name').value.trim();
  const email  = document.getElementById('reg-email').value.trim();
  const wallet = document.getElementById('reg-wallet').value.trim();
  if (!name)                           return showToast('Enter your name', 'error');
  if (!email.match(/\.(ac\.in|edu)$/)) return showToast('Must be a college email (.ac.in or .edu)', 'error');
  if (wallet.length < 10)              return showToast('Enter your Algorand wallet address', 'error');
  document.getElementById('auth-modal').classList.remove('open');
  showToast('ğŸ‰ Account created! Check your college email for OTP.', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, type = 'info') {
  const container = document.getElementById('toasts');
  const toast = document.createElement('div');
  toast.className = `toast toast-${type}`;
  toast.textContent = msg;
  container.appendChild(toast);
  setTimeout(() => {
    toast.style.opacity = '0';
    toast.style.transform = 'translateX(20px)';
    toast.style.transition = '0.3s ease';
    setTimeout(() => toast.remove(), 300);
  }, 3200);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COUNTER ANIMATION (hero stats)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function animateCounter(el, target, suffix = '') {
  let current = 0;
  const duration = 1800;
  const start = performance.now();
  function update(now) {
    const elapsed = now - start;
    const progress = Math.min(elapsed / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);
    const val = Math.round(ease * target);
    el.textContent = val.toLocaleString() + suffix;
    if (progress < 1) requestAnimationFrame(update);
  }
  requestAnimationFrame(update);
}

window.addEventListener('load', () => {
  animateCounter(document.getElementById('stat-listings'), 247);
  animateCounter(document.getElementById('stat-trades'),   1842);
  animateCounter(document.getElementById('stat-users'),    512);
});

// Close modals on overlay click
document.getElementById('buy-modal').addEventListener('click', function(e) {
  if (e.target === this) closeBuyModal();
});
document.getElementById('auth-modal').addEventListener('click', function(e) {
  if (e.target === this) this.classList.remove('open');
});
</script>
</body>
</html>